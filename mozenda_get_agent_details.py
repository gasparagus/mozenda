import requests
import os

agent_list = ['1087',
'1097',
'1107',
'1108',
'1155',
'11460',
'11486',
'11521',
'11523',
'11524',
'11525',
'11526',
'11527',
'11529',
'11530',
'11531',
'11532',
'11534',
'11535',
'11536',
'11539',
'11540',
'11541',
'11542',
'11543',
'11544',
'11545',
'11546',
'11547',
'11548',
'11549',
'11550',
'11552',
'11553',
'11554',
'11555',
'11556',
'11558',
'11559',
'11560',
'11561',
'11563',
'11564',
'11565',
'11566',
'11567',
'11568',
'11569',
'11570',
'11571',
'11572',
'11573',
'11574',
'11575',
'11577',
'11578',
'11579',
'11580',
'11582',
'11587',
'11588',
'11589',
'11590',
'11591',
'11592',
'11593',
'11594',
'11595',
'11596',
'11597',
'11599',
'11601',
'11602',
'11603',
'11604',
'11607',
'11609',
'11610',
'11611',
'11612',
'11613',
'11614',
'11615',
'11617',
'11618',
'11619',
'11620',
'11621',
'11622',
'11623',
'11624',
'11625',
'11626',
'11627',
'11628',
'11630',
'11632',
'11634',
'11635',
'11636',
'11637',
'11638',
'11639',
'11640',
'11641',
'11642',
'11643',
'11645',
'11646',
'11648',
'11649',
'11650',
'11651',
'11652',
'11653',
'11654',
'11655',
'11656',
'11657',
'11658',
'11659',
'11660',
'11661',
'11662',
'11664',
'11665',
'11666',
'11667',
'11668',
'11671',
'11672',
'11673',
'11674',
'11675',
'11676',
'11677',
'11678',
'11679',
'11680',
'11681',
'11682',
'11685',
'11686',
'11688',
'11689',
'11690',
'11692',
'11693',
'11694',
'11695',
'11696',
'11697',
'11698',
'11699',
'11700',
'11701',
'11702',
'11703',
'11704',
'11705',
'11706',
'11707',
'11708',
'11709',
'11710',
'11711',
'11712',
'11713',
'11714',
'11715',
'11716',
'11717',
'11718',
'11719',
'11720',
'11721',
'11722',
'11723',
'11724',
'11725',
'11726',
'11727',
'11728',
'11729',
'11730',
'11731',
'11732',
'11733',
'11734',
'11735',
'11736',
'11737',
'11738',
'11740',
'11741',
'11742',
'11743',
'11744',
'11745',
'11746',
'11747',
'11748',
'11750',
'11752',
'11754',
'11755',
'11756',
'11757',
'11759',
'11760',
'11761',
'11762',
'11763',
'11764',
'11765',
'11766',
'11767',
'11768',
'11770',
'11771',
'11772',
'11774',
'11775',
'11776',
'11778',
'11779',
'11780',
'11782',
'11783',
'11784',
'11785',
'11786',
'11787',
'11788',
'11790',
'11791',
'11792',
'11794',
'11795',
'11796',
'11797',
'11799',
'11800',
'11801',
'11802',
'11803',
'11804',
'11805',
'11806',
'11807',
'11809',
'11811',
'11812',
'11813',
'11814',
'11815',
'11816',
'11818',
'11819',
'11820',
'11821',
'11822',
'11823',
'11824',
'11825',
'11826',
'11828',
'11830',
'11831',
'11832',
'11833',
'11834',
'11836',
'11837',
'11838',
'11840',
'11841',
'11842',
'11843',
'11844',
'11845',
'11846',
'11847',
'11848',
'11849',
'11851',
'11853',
'11854',
'11856',
'11858',
'11859',
'11860',
'11861',
'11862',
'11863',
'11864',
'11866',
'11867',
'11869',
'11870',
'11871',
'11873',
'11874',
'11875',
'11876',
'11877',
'11878',
'11879',
'11883',
'11884',
'11885',
'11886',
'11887',
'11888',
'11889',
'11890',
'11891',
'11892',
'11894',
'11896',
'11897',
'11898',
'11899',
'11900',
'11901',
'11902',
'11903',
'11904',
'21906',
'21907',
'21908',
'21909',
'21910',
'21912',
'21913',
'21915',
'21916',
'21917',
'21918',
'21920',
'21921',
'21922',
'21923',
'21924',
'21925',
'21926',
'21927',
'21928',
'21929',
'21930',
'21931',
'21932',
'21933',
'21934',
'21935',
'21936',
'21937',
'21938',
'21939',
'21940',
'21941',
'21942',
'21943',
'21944',
'21945',
'21946',
'21947',
'21948',
'21949',
'21950',
'21951',
'21952',
'21953',
'21954',
'21955',
'21956',
'21957',
'21958',
'21959',
'21960',
'21961',
'21962',
'21963',
'21964',
'21965',
'21966',
'21967',
'21968',
'21969',
'21970',
'21971',
'21972',
'21973',
'21974',
'21976',
'21977',
'21978',
'21979',
'21981',
'21982',
]

for agent in agent_list:

	# Path to download agents to.
	path = 'C:\Users\glombardo\Desktop\mozenda_backup_20170227'
	os.chdir(path)

	url = 'https://api.mozenda.com/rest?WebServiceKey=04A4A394-875E-49C0-BE97-CDC82AB29DDF&Service=Mozenda10&Operation=Agent.Get&AgentID=' + agent

	r = requests.get(url)

	r_text=r.text.encode('utf-8')

	# Find the positions of each substring for extraction.
	begin_string = '<Agent>'
	end_string = '</Agent>'

	# Agent text.
	begin_postion =  r_text.find(begin_string)
	end_position = r_text.find(end_string)

	# For naming.
	begin_agentid = r_text.find('<AgentID>')
	end_agentid = r_text.find('</AgentID>')

	# Optional if you want to parse the name of the agent out.
	begin_name = r_text.find('<Name>')
	end_name = r_text.find('</Name>')


	agent_filename = agent+'_FULL_AGENT_20170227.xml'

	# Write agent file.
	with open(agent_filename, 'w') as f:
		f.write(r_text[begin_postion:end_position+len(str('</Agent>'))])

	agent_attribute_filename = agent+'_ATTRIBUTE_FILE_'+'_20170227.xml'
	# Write attribute file.
	with open(agent_attribute_filename, 'w') as f:
		f.write(r_text[:begin_postion])

